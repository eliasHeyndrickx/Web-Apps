var express=require("express"),app=express(),router=express.Router(),bodyParser=require("body-parser");app.use(express["static"](__dirname+"/public")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use("/",router);var mongoose=require("mongoose"),Board=require("./model/board.js"),seeder=require("seeder"),board_overview=require("./seeds/overview.json");mongoose.connect("mongodb://localhost/hexchan"),mongoose.connection.on("open",function(e){if(e)throw e;seeder(board_overview,mongoose,console.log,function(e){e&&console.log(e),console.log("Seeding complete!")})}),router.param("boardId",function(e,o,r,n){var s=Board.find({_id:n});s.exec(function(o,n){return o?r(o):n?(console.log(n),e.board=n,r()):r(new Error("Can't find board!"))})}),router.get("/boards",function(e,o){Board.find({},function(e,r){e&&console.log(e),o.json(r)})}),router.get("/board/:boardId",function(e,o,r){o.json(e.board)}),router.get("/public",function(e,o){o.sendfile("./dist/index.html")}),console.log("Starting up server!"),app.listen(process.env.PORT||3e3);